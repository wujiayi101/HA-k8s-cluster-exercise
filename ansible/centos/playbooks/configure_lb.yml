---
- hosts: haproxy
  become: yes
  vars_files:
  - env_variables
  tasks:
    - name: Install EPEL repository
      yum:
        name: epel-release
        state: present

    - name: Install HAProxy
      yum:
        name: haproxy
        state: present

    # - name: Adding lb settings to existing config
    #   blockinfile:
    #   path: /etc/yum.repos.d/kubernetes.repo
    #   block: |
    #     [kubernetes]
    #     name=Kubernetes
    #     baseurl=https://packages.cloud.google.com/yum/repos/kubernetes-el7-x86_64
    #     enabled=1
    #     gpgcheck=1
    #     repo_gpgcheck=1
    #     gpgkey=https://packages.cloud.google.com/yum/doc/yum-key.gpg
    #       https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg